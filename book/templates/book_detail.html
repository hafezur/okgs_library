{% extends "index.html" %}
{% block content %}

<style>
  body {
    background: linear-gradient(135deg, #fdfbfb, #ebedee);
    font-family: 'Poppins', sans-serif;
  }

  .insta-card {
    background: #fff;
    border-radius: 30px;
    padding: 28px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    transition: 0.3s ease;
    position: relative;
    animation: fadeIn 0.8s ease;
  }

  @keyframes fadeIn {
    from {opacity:0; transform: translateY(20px);}
    to {opacity:1; transform: translateY(0);}
  }

  .insta-img {
    border-radius: 22px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: .3s;
  }
  .insta-img:hover {
    transform: scale(1.03);
  }

  .insta-title {
    font-weight: 700;
    color: #111;
    font-size: 28px;
  }

  .insta-label {
    font-weight: 600;
    color: #777;
  }

  .insta-btn {
    border-radius: 40px;
    font-weight: 600;
    padding: 10px 25px;
    transition: 0.25s;
    font-size: 16px;
  }

  .insta-btn:hover {
    transform: scale(1.07);
  }

  .btn-edit {
    background: #ffd369;
    border: none;
    color: #000;
  }

  .btn-delete {
    background: #ff6b6b;
    border: none;
    color: #fff;
  }

  .btn-back {
    border: 2px solid #ddd;
    background: #fff;
    color: #333;
  }

  .divider {
    width: 80px;
    height: 4px;
    border-radius: 6px;
    background: #ff6b6b;
    margin: 15px auto;
  }

  /* PRICE BADGE */
  .price-badge {
    position: absolute;
    top: 20px;
    right: 20px;
    background: linear-gradient(45deg, #f09433, #dc2743, #bc1888);
    color: white;
    padding: 8px 16px;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 700;
    box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  }

  /* LOGIN WARNING CARD */
  .login-warning {
    background: #fff;
    padding: 50px;
    border-radius: 30px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
    text-align: center;
    animation: bounceIn 1s ease;
  }

  @keyframes bounceIn {
    0% {transform: scale(0.8); opacity:0;}
    60% {transform: scale(1.05);}
    100% {transform: scale(1); opacity:1;}
  }

  .login-warning h2 {
    font-weight: 700;
    color: #dc2743;
  }

  .login-warning p {
    color: #666;
    font-size: 17px;
  }

  .login-btn {
    background: linear-gradient(45deg, #f09433, #dc2743, #bc1888);
    border: none;
    color: white;
    padding: 12px 30px;
    border-radius: 30px;
    font-weight: 600;
    transition: 0.3s;
  }

  .login-btn:hover {
    transform: scale(1.08);
  }
</style>

<div class="container py-5">

{% if custom_user  %}

  <!-- AUTHENTICATED USER VIEW -->

  <div class="text-center mb-5">
    <h1 class="insta-title">üìö Book Information</h1>
    <p class="text-muted">View and manage all details of this book</p>
    <div class="divider"></div>
  </div>

  <div class="insta-card mx-auto" style="max-width: 900px;">

    <div class="price-badge">‡ß≥ {{ item.price }}</div>

    <div class="row g-4">

      <div class="col-md-4 text-center">
        {% if item.book_image %}
          <img src="{{ item.book_image.url }}" class="img-fluid insta-img" style="max-height:240px;">
        {% else %}
          <img src="https://cdn-icons-png.flaticon.com/512/29/29302.png" class="img-fluid insta-img" style="max-height:240px;">
        {% endif %}
      </div>

      <div class="col-md-8">
        <h2 class="insta-title mb-3">{{ item.book_name }}</h2>

        <p><span class="insta-label">Author:</span> {{ item.author }}</p>
        <p><span class="insta-label">Category:</span> {{ item.category }}</p>
        <p><span class="insta-label">First Publication:</span> {{ item.first_pub }}</p>
        <p><span class="insta-label">Last Publication:</span> {{ item.last_pub }}</p>
        <p><span class="insta-label">Book ID:</span> #{{ item.id }}</p>
        <p><span class="insta-label">Price:</span> ‡ß≥ {{ item.price }}</p>
      </div>
    </div>

    <hr class="my-4">
     {% if is_adm %}
    <div class="d-flex justify-content-center gap-3 mt-3">
      <a href="{% url 'edit_book' id=item.id %}" class="btn insta-btn btn-edit">Edit Book</a>
      <a href="{% url 'read_book' item.id %}" class="btn insta-btn btn-edit">Read</a>
      <a href="{% url 'delete_book' pk=item.id %}" class="btn insta-btn btn-delete" onclick="return confirm('Are you sure?');">Delete</a>
      <a href="{% url 'show_books' %}" class="btn insta-btn btn-back">‚Üê Back</a>
    </div>
    {% else %}
    <div class="d-flex justify-content-center gap-3 mt-3">
      <a href="{% url 'edit_book' pk=item.id %}" class="btn insta-btn btn-edit">Make Order</a>
      <a href="{% url 'read_book' item.id %}" class="btn insta-btn btn-edit">Read</a>
      <a href="{% url 'delete_book' pk=item.id %}" class="btn insta-btn btn-delete" onclick="return confirm('Are you sure?');">Purchase</a>
      <a href="{% url 'show_books' %}" class="btn insta-btn btn-back">‚Üê Back</a>
    </div>
    {% endif %}

  </div>

{% else %}

  <!-- NON AUTHENTICATED USER VIEW -->

  <div class="login-warning mx-auto" style="max-width:600px;">
    <h2>üîí Login Required</h2>
    <p>
      To view full book details, please login to your account.<br>
      Enjoy premium access to our library after login.
    </p>
    <a href="{% url 'user_login' %}?next={{ request.path }}" class="login-btn mt-3 d-inline-block">Login Now ‚Üí</a>
  </div>

{% endif %}

</div>

{% endblock %}
